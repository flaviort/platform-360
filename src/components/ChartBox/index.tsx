// libraries
import clsx from 'clsx'

// components
import DeleteChart from '@/components/DeleteChart'
import PricePointAnalysis from '@/components/Reports/Charts/PricePointAnalysis'
import PricePointByRetailer from '@/components/Reports/Charts/PricePointByRetailer'
import PriceDistributionByBrand from '@/components/Reports/Charts/PriceDistributionByBrand'
import SkuAnalysis from '@/components/Reports/Charts/SkuAnalysis'
import Colors from '@/components/Reports/Charts/Colors'
import VerticalBars from '@/components/Reports/Charts/VerticalBars'
import HorizontalBars from '@/components/Reports/Charts/HorizontalBars'
import PositiveNegativeBars from '@/components/Reports/Charts/PositiveNegativeBars'

// non-chart components
import ProductPrice from '@/components/Reports/NonCharts/ProductPrice'

// svg
import { Sparkle } from 'lucide-react'

// styles
import styles from './index.module.scss'

// interface
interface ChartBoxProps {
    id: string
    title?: string
    description?: string
    AIGenerated?: boolean
    AIChatChart?: boolean
    boxSize: 'half' | 'full'
    chartType: string
    chart: {
        pricePointAnalysis?: Array<{
            id: string
            count: number
        }>
        pricePointByRetailer?: Array<{
            company: string
            min: number
            avg: number
            max: number
        }>
        priceDistributionByBrand?: Array<{
            brand: string
            price: number
        }>
        skuAnalysis?: Array<{
            company: string
            count: number
        }>
        colors?: Array<{
            color: string
            count: number
        }>

        // old charts
        vertical?: Array<{
            label: string
            value: number
        }>
        horizontal?: Array<{
            name: string
            value: number
            color: string
        }>
        positiveNegative?: Array<{
            name: string
            value: number
            color: string
        }>
    }
    reportSummary: {
		retailers?: string[]
		brands?: string[]
		genders?: string[]
		age?: string
		type?: string
		includeImages?: boolean
		timePeriod?: string
		location?: string
		regions?: string[]
		priceRange?: string
	}
}

export default function ChartBox({
    id,
    title,
    description,
    AIGenerated,
    AIChatChart,
    boxSize = 'half',
    chartType,
    chart,
    reportSummary
}: ChartBoxProps) {
    return (
        <div className={clsx(
            styles.component,
            boxSize === 'full' && styles.full,
            boxSize === 'half' && styles.half
        )}>

            <div className={styles.header}>

                {!AIChatChart && (title || description) && (
                    <div className={styles.left}>

                        {title && (
                            <h3 className='bold'>
                                {title}
                            </h3>
                        )}

                        {description && (
                            <p className='text-14'>
                                {description}
                            </p>
                        )}

                    </div>
                )}

                <div className={styles.right}>

                    {!AIChatChart && AIGenerated && (
                        <div
                            className={styles.AIGenerated}
                            aria-label='This chart was generated by A.I.'
                            data-balloon-pos='up'
                        >

                            <Sparkle />

                            <span className='text-12 semi-bold'>
                                Gen by A.I.
                            </span>

                        </div>
                    )}

                    <DeleteChart id={id} />

                </div>

            </div>

            <div className={styles.chart} data-chart-type={chartType}>

                {chart.pricePointAnalysis && (
                    <PricePointAnalysis
                        data={chart.pricePointAnalysis}
                        //reportSummary={reportSummary}
                    />
                )}

                {chart.pricePointByRetailer && (
                    <PricePointByRetailer
                        data={chart.pricePointByRetailer}
                        reportSummary={{
                            ...reportSummary,
                            regions: reportSummary.regions?.join(',')
                        }}
                    />
                )}

                {chart.skuAnalysis && (
                    <SkuAnalysis
                        data={chart.skuAnalysis}
                        reportSummary={{
                            ...reportSummary,
                            regions: reportSummary.regions?.join(',')
                        }}
                    />
                )}

                {chart.priceDistributionByBrand && (
                    <PriceDistributionByBrand
                        data={chart.priceDistributionByBrand}
                        //reportSummary={reportSummary}
                    />
                )}

                {chart.colors && (
                    <Colors
                        data={chart.colors}
                        //reportSummary={reportSummary}
                    />
                )}

                {/* --- other charts  --- */}

                {chart.vertical && (
                    <VerticalBars
                        data={chart.vertical}
                        //reportSummary={reportSummary}
                    />
                )}

                {chart.horizontal && (
                    <HorizontalBars
                        data={chart.horizontal}
                        //reportSummary={reportSummary}
                    />
                )}

                {chart.positiveNegative && (
                    <PositiveNegativeBars
                        data={chart.positiveNegative}
                        //reportSummary={reportSummary}
                    />
                )}

            </div>

        </div>
    )
}